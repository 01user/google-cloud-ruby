<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <title>Gcloud::Datastore &mdash; Gcloud Documentation</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//googlecloudplatform.github.io/gcloud-ruby/css/normalize.css">
    <link rel="stylesheet" href="//googlecloudplatform.github.io/gcloud-ruby/css/main.css">
    <script src="//googlecloudplatform.github.io/gcloud-ruby/js/vendor/modernizr-2.6.2.min.js"></script>
    <link href='//fonts.googleapis.com/css?family=Droid+Sans+Mono|Roboto:300,400,700,700italic,400italic|Open+Sans:300' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" href="https://cloud.google.com/images/gcp-favicon.ico">
  </head>

  <body class="lang-page">
    <!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <header class="page-header fixed" role="banner">
      <h1 class="logo">
        <a href="//googlecloudplatform.github.io/gcloud-ruby/" title="back to home">
          <img src="//googlecloudplatform.github.io/gcloud-ruby/img/logo.svg" alt="Google Cloud Platform">
          <span class="gcloud">gcloud</span>
        </a>
      </h1>

      <nav class="main-nav">
        <div class="nav-current">Ruby</div>
        <ul class="menu">
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-java/" title="gcloud-java">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-java.svg" alt="Java icon" class="menu-icon" />
              Java
            </a>
          </li>
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-node/#/docs" title="gcloud-node">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-nodejs.svg" alt="Node.js icon" class="menu-icon">
              Node.js
            </a>
          </li>
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-python/latest/" title="gcloud-python">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-python.svg" alt="Python icon" class="menu-icon">
              Python
            </a>
          </li>
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-ruby/" title="gcloud-ruby">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-ruby.svg" alt="Ruby icon" class="menu-icon" width="24">
              Ruby
            </a>
          </li>
        </ul>
      </nav>

      <div class="github-issue">
        <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby/issues/new?title=%5BDocumentation+Issue%5D+" target="_blank" class="v-btn">
          <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-github.svg" />
          Report an Issue
        </a>
      </div>
    </header>

    <article class="main lang-page" role="main">

      <header class="docs-header">
        <h1 class="page-title">Gcloud::Datastore</h1>
      </header>

      <section class="content">

        <div id="description" class="description">
          <h1 id="google-cloud-datastore">Google Cloud Datastore</h1>

<p>Google Cloud Datastore is a fully managed, schemaless database for storing
non-relational data. You should feel at home if you are familiar with
relational databases, but there are some key differences to be aware of to
make the most of using Datastore.</p>

<p>The goal of gcloud-ruby is to provide a API that is comfortable to
Rubyists. Authentication is handled by <span class='object_link'><a href="../Gcloud.html#datastore-instance_method" title="Gcloud#datastore (method)">#datastore</a></span>. You can provide
the project and credential information to connect to the Datastore service,
or if you are running on Google Compute Engine this configuration is taken
care of for you.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span> <span class="s2">"my-todo-project"</span><span class="p">,</span>
                    <span class="s2">"/path/to/keyfile.json"</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">find</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>
<span class="n">task</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">datastore</span><span class="p">.</span><span class="nf">save</span> <span class="n">task</span>
</code></pre>
</div>

<p>You can learn more about various options for connection on the
<a href="https://googlecloudplatform.github.io/gcloud-ruby/#/docs/guides/authentication">Authentication
Guide</a>.</p>

<p>To learn more about Datastore, read the
<a href="https://cloud.google.com/datastore/docs/concepts/overview">Google Cloud Datastore Concepts Overview
</a>.</p>

<h2 id="retrieving-records">Retrieving records</h2>

<p>Records, called “entities” in Datastore, are retrieved by using a key.
The key is more than a numeric identifier, it is a complex data structure
that can be used to model relationships. The simplest key has a string
<tt>kind</tt> value, and either a numeric <tt>id</tt> value, or a string
<tt>name</tt> value. A single record can be retrieved by calling
<span class='object_link'><a href="Datastore/Dataset.html#find-instance_method" title="Gcloud::Datastore::Dataset#find (method)">Dataset#find</a></span> and passing the parts of the key:</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">find</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>
</code></pre>
</div>

<p>Optionally, <span class='object_link'><a href="Datastore/Dataset.html#find-instance_method" title="Gcloud::Datastore::Dataset#find (method)">Dataset#find</a></span> can be given a key object:</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="mi">123456</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">find</span> <span class="n">task_key</span>
</code></pre>
</div>

<p>See <span class='object_link'><a href="Datastore/Dataset.html#find-instance_method" title="Gcloud::Datastore::Dataset#find (method)">Dataset#find</a></span></p>

<h2 id="querying-records">Querying records</h2>

<p>Multiple records can be found that match criteria.
(See <span class='object_link'><a href="Datastore/Query.html#where-instance_method" title="Gcloud::Datastore::Query#where (method)">Query#where</a></span>)</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"Task"</span><span class="p">).</span>
  <span class="nf">where</span><span class="p">(</span><span class="s2">"done"</span><span class="p">,</span> <span class="s2">"="</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span> <span class="n">query</span>
</code></pre>
</div>

<p>Records can also be ordered. (See <span class='object_link'><a href="Datastore/Query.html#order-instance_method" title="Gcloud::Datastore::Query#order (method)">Query#order</a></span>)</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"Task"</span><span class="p">).</span>
  <span class="nf">order</span><span class="p">(</span><span class="s2">"created"</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span> <span class="n">query</span>
</code></pre>
</div>

<p>The number of records returned can be specified.
(See <span class='object_link'><a href="Datastore/Query.html#limit-instance_method" title="Gcloud::Datastore::Query#limit (method)">Query#limit</a></span>)</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"Task"</span><span class="p">).</span>
  <span class="nf">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span> <span class="n">query</span>
</code></pre>
</div>

<p>Records’ key structures can also be queried.
(See <span class='object_link'><a href="Datastore/Query.html#ancestor-instance_method" title="Gcloud::Datastore::Query#ancestor (method)">Query#ancestor</a></span>)</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task_list_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"TaskList"</span><span class="p">,</span> <span class="s2">"default"</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"Task"</span><span class="p">).</span>
  <span class="nf">ancestor</span><span class="p">(</span><span class="n">task_list_key</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span> <span class="n">query</span>
</code></pre>
</div>

<p>See <span class='object_link'><a href="Datastore/Query.html" title="Gcloud::Datastore::Query (class)">Query</a></span> and <span class='object_link'><a href="Datastore/Dataset.html#run-instance_method" title="Gcloud::Datastore::Dataset#run (method)">Dataset#run</a></span></p>

<h3 id="paginating-records">Paginating records</h3>

<p>All records may not return at once, but multiple calls can be made to
Datastore to return them all.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"Task"</span><span class="p">)</span>
<span class="n">tasks</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span> <span class="n">query</span>
<span class="n">tasks</span><span class="p">.</span><span class="nf">all</span> <span class="k">do</span> <span class="o">|</span><span class="n">task</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>See <span class='object_link'><a href="Datastore/Dataset/LookupResults.html" title="Gcloud::Datastore::Dataset::LookupResults (class)">Dataset::LookupResults</a></span> and
<span class='object_link'><a href="Datastore/Dataset/QueryResults.html" title="Gcloud::Datastore::Dataset::QueryResults (class)">Dataset::QueryResults</a></span></p>

<h2 id="creating-records">Creating records</h2>

<p>New entities can be created and persisted buy calling
<span class='object_link'><a href="Datastore/Dataset.html#save-instance_method" title="Gcloud::Datastore::Dataset#save (method)">Dataset#save</a></span>. The entity must have a key to be saved.
If the key is incomplete then it will be completed when saved.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="s2">"Task"</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Personal"</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Learn Cloud Datastore"</span>
<span class="k">end</span>
<span class="n">task</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">id</span> <span class="c1">#=&gt; nil</span>
<span class="n">datastore</span><span class="p">.</span><span class="nf">save</span> <span class="n">task</span>
<span class="n">task</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">id</span> <span class="c1">#=&gt; 123456</span>
</code></pre>
</div>

<p>Multiple new entities may be created in a batch.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task1</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="s2">"Task"</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Personal"</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Learn Cloud Datastore"</span>
<span class="k">end</span>

<span class="n">task2</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="s2">"Task"</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Personal"</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Integrate Cloud Datastore"</span>
<span class="k">end</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">task1</span><span class="p">,</span> <span class="n">task2</span><span class="p">)</span>
<span class="n">task_key1</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">key</span>
<span class="n">task_key2</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">key</span>
</code></pre>
</div>

<p>Entities in Datastore form a hierarchically structured space similar to the
directory structure of a file system. When you create an entity, you can
optionally designate another entity as its parent; the new entity is a child
of the parent entity.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="n">task_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>
<span class="n">task_key</span><span class="p">.</span><span class="nf">parent</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"TaskList"</span><span class="p">,</span> <span class="s2">"default"</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="n">task_key</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Personal"</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Integrate Cloud Datastore"</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="setting-properties">Setting properties</h2>

<p>Entities hold properties. A property has a name that is a string or symbol,
and a value that is an object. Most value objects are supported, including
String, Integer, Date, Time, and even other entity or key objects. Changes
to the entity’s properties are persisted by calling
<span class='object_link'><a href="Datastore/Dataset.html#save-instance_method" title="Gcloud::Datastore::Dataset#save (method)">Dataset#save</a></span>.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">find</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>
<span class="c1"># Read the priority property</span>
<span class="n">task</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="c1">#=&gt; 4</span>
<span class="c1"># Write the priority property</span>
<span class="n">task</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># Persist the changes</span>
<span class="n">datastore</span><span class="p">.</span><span class="nf">save</span> <span class="n">task</span>
</code></pre>
</div>

<p>Array properties can be used to store more than one value.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"tags"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"fun"</span><span class="p">,</span> <span class="s2">"programming"</span><span class="p">]</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"collaborators"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"alice"</span><span class="p">,</span> <span class="s2">"bob"</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="deleting-records">Deleting records</h2>

<p>Entities can be removed from Datastore by calling
<span class='object_link'><a href="Datastore/Dataset.html#delete-instance_method" title="Gcloud::Datastore::Dataset#delete (method)">Dataset#delete</a></span> and passing the entity object or the
entity’s key object.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">find</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>
<span class="n">datastore</span><span class="p">.</span><span class="nf">delete</span> <span class="n">task</span>
</code></pre>
</div>

<p>Multiple entities may be deleted in a batch.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task_key1</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask1"</span>
<span class="n">task_key2</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask2"</span>
<span class="n">datastore</span><span class="p">.</span><span class="nf">delete</span> <span class="n">task_key1</span><span class="p">,</span> <span class="n">task_key2</span>
</code></pre>
</div>

<h2 id="transactions">Transactions</h2>

<p>Complex logic can be wrapped in a Transaction. All queries and updates
within the <span class='object_link'><a href="Datastore/Dataset.html#transaction-instance_method" title="Gcloud::Datastore::Dataset#transaction (method)">Dataset#transaction</a></span> block are run within the
transaction scope, and will be automatically committed when the block
completes.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>

<span class="n">datastore</span><span class="p">.</span><span class="nf">transaction</span> <span class="k">do</span> <span class="o">|</span><span class="n">tx</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">tx</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">task_key</span><span class="p">).</span><span class="nf">nil?</span>
    <span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="n">task_key</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Personal"</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Learn Cloud Datastore"</span>
    <span class="k">end</span>
    <span class="n">tx</span><span class="p">.</span><span class="nf">save</span> <span class="n">task</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Alternatively, if no block is given the transaction object is returned
allowing you to commit or rollback manually.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"sampleTask"</span>

<span class="n">tx</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">transaction</span>
<span class="k">begin</span>
  <span class="k">if</span> <span class="n">tx</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">task_key</span><span class="p">).</span><span class="nf">nil?</span>
    <span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="n">task_key</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Personal"</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Learn Cloud Datastore"</span>
    <span class="k">end</span>
    <span class="n">tx</span><span class="p">.</span><span class="nf">save</span> <span class="n">task</span>
  <span class="k">end</span>
  <span class="n">tx</span><span class="p">.</span><span class="nf">commit</span>
<span class="k">rescue</span>
  <span class="n">tx</span><span class="p">.</span><span class="nf">rollback</span>
<span class="k">end</span>
</code></pre>
</div>

<p>See <span class='object_link'><a href="Datastore/Transaction.html" title="Gcloud::Datastore::Transaction (class)">Transaction</a></span> and
<span class='object_link'><a href="Datastore/Dataset.html#transaction-instance_method" title="Gcloud::Datastore::Dataset#transaction (method)">Dataset#transaction</a></span></p>

<h2 id="querying-metadata">Querying metadata</h2>

<p>Datastore provides programmatic access to some of its metadata to support
meta-programming, implementing backend administrative functions, simplify
consistent caching, and similar purposes. The metadata available includes
information about the entity groups, namespaces, entity kinds, and
properties your application uses, as well as the property representations
for each property.</p>

<p>The special entity kind <code class="highlighter-rouge">__namespace__</code> can be used to find all the
namespaces used in your application entities.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"__namespace__"</span><span class="p">).</span>
  <span class="nf">select</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">).</span>
  <span class="nf">where</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">,</span> <span class="s2">"&gt;="</span><span class="p">,</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span><span class="p">(</span><span class="s2">"__namespace__"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">)).</span>
  <span class="nf">where</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">,</span> <span class="s2">"&lt;"</span><span class="p">,</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span><span class="p">(</span><span class="s2">"__namespace__"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">))</span>

<span class="n">namespaces</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">query</span><span class="p">).</span><span class="nf">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">entity</span><span class="o">|</span>
  <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">name</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The special entity kind <code class="highlighter-rouge">__kind__</code> can be used to return all the
kinds used in your application.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"__kind__"</span><span class="p">).</span>
  <span class="nf">select</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">)</span>

<span class="n">kinds</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">query</span><span class="p">).</span><span class="nf">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">entity</span><span class="o">|</span>
  <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">name</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Property queries return entities of kind <code class="highlighter-rouge">__property__</code> denoting the indexed
properties associated with an entity kind. (Unindexed properties are not
included.)</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"__property__"</span><span class="p">).</span>
  <span class="nf">select</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">)</span>

<span class="n">entities</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">properties_by_kind</span> <span class="o">=</span> <span class="n">entities</span><span class="p">.</span><span class="nf">each_with_object</span><span class="p">({})</span> <span class="k">do</span> <span class="o">|</span><span class="n">entity</span><span class="p">,</span> <span class="n">memo</span><span class="o">|</span>
  <span class="n">kind</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">parent</span><span class="p">.</span><span class="nf">name</span>
  <span class="n">prop</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">name</span>
  <span class="n">memo</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span> <span class="o">||=</span> <span class="p">[]</span>
  <span class="n">memo</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">prop</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Property queries support ancestor filtering on a <code class="highlighter-rouge">__kind__</code> or
<code class="highlighter-rouge">__property__</code> key, to limit the query results to a single kind or property.
The <code class="highlighter-rouge">property_representation</code> property in the entity representing property
<code class="highlighter-rouge">p</code> of kind <code class="highlighter-rouge">k</code> is an array containing all representations of <code class="highlighter-rouge">p</code>’s value in
any entity of kind <code class="highlighter-rouge">k</code>.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="n">ancestor_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"__kind__"</span><span class="p">,</span> <span class="s2">"Task"</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"__property__"</span><span class="p">).</span>
  <span class="nf">ancestor</span><span class="p">(</span><span class="n">ancestor_key</span><span class="p">)</span>

<span class="n">entities</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">representations</span> <span class="o">=</span> <span class="n">entities</span><span class="p">.</span><span class="nf">each_with_object</span><span class="p">({})</span> <span class="k">do</span> <span class="o">|</span><span class="n">entity</span><span class="p">,</span> <span class="n">memo</span><span class="o">|</span>
  <span class="n">property_name</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">name</span>
  <span class="n">property_types</span> <span class="o">=</span> <span class="n">entity</span><span class="p">[</span><span class="s2">"property_representation"</span><span class="p">]</span>
  <span class="n">memo</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">property_types</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Property queries can also be filtered with a range over the pseudo-property
<code class="highlighter-rouge">__key__</code>, where the keys denote either <code class="highlighter-rouge">__kind__</code> or <code class="highlighter-rouge">__property__</code>
entities.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="n">start_key</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"__property__"</span><span class="p">,</span> <span class="s2">"priority"</span>
<span class="n">start_key</span><span class="p">.</span><span class="nf">parent</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">key</span> <span class="s2">"__kind__"</span><span class="p">,</span> <span class="s2">"Task"</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="s2">"__property__"</span><span class="p">).</span>
  <span class="nf">select</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">).</span>
  <span class="nf">where</span><span class="p">(</span><span class="s2">"__key__"</span><span class="p">,</span> <span class="s2">"&gt;="</span><span class="p">,</span> <span class="n">start_key</span><span class="p">)</span>

<span class="n">entities</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">properties_by_kind</span> <span class="o">=</span> <span class="n">entities</span><span class="p">.</span><span class="nf">each_with_object</span><span class="p">({})</span> <span class="k">do</span> <span class="o">|</span><span class="n">entity</span><span class="p">,</span> <span class="n">memo</span><span class="o">|</span>
  <span class="n">kind</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">parent</span><span class="p">.</span><span class="nf">name</span>
  <span class="n">prop</span> <span class="o">=</span> <span class="n">entity</span><span class="p">.</span><span class="nf">key</span><span class="p">.</span><span class="nf">name</span>
  <span class="n">memo</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span> <span class="o">||=</span> <span class="p">[]</span>
  <span class="n">memo</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">prop</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="configuring-backoff">Configuring Backoff</h2>

<p>The <span class='object_link'><a href="Backoff.html" title="Gcloud::Backoff (class)">Backoff</a></span> class allows users to globally configure how Cloud API
requests are automatically retried in the case of some errors, such as a
<code class="highlighter-rouge">500</code> or <code class="highlighter-rouge">503</code> status code, or a specific internal error code such as
<code class="highlighter-rouge">rateLimitExceeded</code>.</p>

<p>If an API call fails, the response will be inspected to see if the call
should be retried. If the response matches the criteria, then the request
will be retried after a delay. If another error occurs, the delay will be
increased incrementally before a subsequent attempt. The first retry will be
delayed one second, the second retry two seconds, and so on.</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>
<span class="nb">require</span> <span class="s2">"gcloud/backoff"</span>

<span class="no">Gcloud</span><span class="o">::</span><span class="no">Backoff</span><span class="p">.</span><span class="nf">retries</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Raise the maximum number of retries from 3</span>
</code></pre>
</div>

<p>See the <a href="https://cloud.google.com/datastore/docs/concepts/errors#error_codes">Datastore error
codes</a>
for a list of error conditions.</p>

<h2 id="the-cloud-datastore-emulator">The Cloud Datastore Emulator</h2>

<p>As of this release, the Cloud Datastore emulator that is part of the gcloud
SDK is no longer compatible with gcloud-ruby. This is because the gcloud
SDK’s Cloud Datastore emulator does not yet support gRPC as a transport
layer.</p>

<p>A gRPC-compatible emulator is available until the gcloud SDK Cloud Datastore
emulator supports gRPC. To use it you must <a href="https://storage.googleapis.com/gcd/tools/cloud-datastore-emulator-1.1.1.zip">download the gRPC
emulator</a>
and use the <code class="highlighter-rouge">cloud_datastore_emulator</code> script.</p>

<p>When you run the Cloud Datastore emulator you will see a message similar to
the following printed:</p>

<div class="highlighter-rouge"><pre class="ruby"><code>If you are using a library that supports the DATASTORE_EMULATOR_HOST
environment variable, run:

export DATASTORE_EMULATOR_HOST=localhost:8978
</code></pre>
</div>

<p>Now you can connect to the emulator using the <code class="highlighter-rouge">DATASTORE_EMULATOR_HOST</code>
environment variable:</p>

<div class="language-ruby highlighter-rouge"><pre class="ruby"><code><span class="nb">require</span> <span class="s2">"gcloud"</span>

<span class="c1"># Make Datastore use the emulator</span>
<span class="no">ENV</span><span class="p">[</span><span class="s2">"DATASTORE_EMULATOR_HOST"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"localhost:8978"</span>

<span class="n">gcloud</span> <span class="o">=</span> <span class="no">Gcloud</span><span class="p">.</span><span class="nf">new</span> <span class="s2">"emulator-project-id"</span>
<span class="n">datastore</span> <span class="o">=</span> <span class="n">gcloud</span><span class="p">.</span><span class="nf">datastore</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">datastore</span><span class="p">.</span><span class="nf">entity</span> <span class="s2">"Task"</span><span class="p">,</span> <span class="s2">"emulatorTask"</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Testing"</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"done"</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"priority"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">t</span><span class="p">[</span><span class="s2">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Use Datastore Emulator"</span>
<span class="k">end</span>

<span class="n">datastore</span><span class="p">.</span><span class="nf">save</span> <span class="n">task</span>
</code></pre>
</div>

        </div>

        <div class="section-links">
          

          
          

          
        </div>

        
      </section>

      <nav class="side-nav">

        <div class="side-nav--meta"><div id="doc-build-date">Docs built on Jul 11, 2016.</div></div><ul><h4 class="list-item--heading">Getting Started</h4><li class='toc-l0'><a class='reference internal' href='../index.html'>Overview</a></li><li class='toc-l0'><a class='reference internal' href='../AUTHENTICATION.html'>Authentication Guide</a></li></ul><ul><h4 class="list-item--heading">API</h4><li class='toc-l0'><a class='reference internal' href='../Gcloud.html'>Gcloud</a></li><li class='toc-l0'><a class='reference internal' href='Bigquery.html'>BigQuery</a></li><li class='toc-l0'><a class='reference internal current' href=''>Datastore</a></li><li class='toc-l1'><a class='reference internal' href='Datastore/Dataset.html'>Dataset</a></li><li class='toc-l1'><a class='reference internal' href='Datastore/Query.html'>Query</a></li><li class='toc-l1'><a class='reference internal' href='Datastore/Entity.html'>Entity</a></li><li class='toc-l1'><a class='reference internal' href='Datastore/Key.html'>Key</a></li><li class='toc-l0'><a class='reference internal' href='Dns.html'>DNS</a></li><li class='toc-l0'><a class='reference internal' href='Logging.html'>Logging</a></li><li class='toc-l0'><a class='reference internal' href='Pubsub.html'>Pub/Sub</a></li><li class='toc-l0'><a class='reference internal' href='ResourceManager.html'>Resource Manager</a></li><li class='toc-l0'><a class='reference internal' href='Storage.html'>Storage</a></li><li class='toc-l0'><a class='reference internal' href='Translate.html'>Translate</a></li><li class='toc-l0'><a class='reference internal' href='../reference.html'>API Reference</a></li></ul>

        <ul class="external-links">
          <li>
            <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby" title="Github repository">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-github.svg" alt="Github icon">
              Github
            </a>
          </li>
          <li>
            <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby/issues" title="Issues on Github">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-issues.svg" alt="Issues icon">
              Issues
            </a>
          </li>
          <li>
            <a href="http://stackoverflow.com/questions/tagged/gcloud-ruby" title="gcloud on StackOverflow">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-stackoverflow.svg" alt="StackOverflow icon">
              StackOverflow
            </a>
          </li>
          <li>
            <a href="http://rubygems.org/gems/gcloud" title="RubyGems" class="ext-link">
               <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-rubygems.svg" alt="RubyGems icon">
              RubyGems
            </a>
          </li>
        </ul>

      </nav>

    </article>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script ="//googlecloudplatform.github.io/gcloud-ruby/js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
    <script src="//googlecloudplatform.github.io/gcloud-ruby/js/plugins.js"></script>
    <script src="//googlecloudplatform.github.io/gcloud-ruby/js/main.js"></script>

    <script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create','UA-49880327-13');ga('send','pageview');
    </script>

  </body>
</html>
